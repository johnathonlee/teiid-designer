<chapter id="monitored_connectors">
  <title>Monitored Connectors</title>
  <sect1>
    <title>Overview</title>
    <para>The Teiid Connector API contains an optional interface that allows connectors to
      be automatically monitored by the Teiid Enterprise Server or checked via the Teiid
      Admin API.  </para>
  </sect1>
  <sect1>
    <title>Monitored Connector Framework Overview</title>
    <para>This UML diagram shows the classes involved in the monitored connector classes.  
    </para>
      
    <figure id="monitored-connector-framework">
      <title>Monitored Connector Class Diagram</title>
      <graphic align="center" scale="100" fileref="../images/monitored-connector-framework.png" />
    </figure>

    <para>The table below lists the role of each class in the framework.</para>
    
      <table frame="all">
        <title>Monitored Connector Classes</title>
        <tgroup cols='3' align='left' colsep='1' rowsep='1'>
          <colspec colname='c1' colwidth="1*" />
          <colspec colname='c2' colwidth="1*" />
          <colspec colname='c3' colwidth="2*" />
          <thead>
            <row>
              <entry>
                <para>Class</para>
              </entry>
              <entry>
                <para>Type</para>
              </entry>
              <entry>
                <para>Description</para>
              </entry>
            </row>          
          </thead>    
          <tbody>
            <row>
              <entry>
                <para>MonitoredConnector</para>
              </entry>
              <entry>
                <para>Interface</para>
              </entry>
              <entry>
                <para>This interface can be added to the Connector implementation to indicate that
                  the connector supports monitoring.  </para>
              </entry>
            </row>
            <row>
              <entry>
                <para>ConnectionStatus</para>
              </entry>
              <entry>
                <para>Class</para>
              </entry>
              <entry>
                <para />
              </entry>
            </row>
            <row>
              <entry>
                <para>AliveStatus</para>
              </entry>
              <entry>
                <para>Class</para>
              </entry>
              <entry>
                <para>This class defines an enumeration for valid status values for a
                  ConnectionStatus.</para>
              </entry>
            </row>
          </tbody>
      </tgroup>
    </table>
    </sect1>
    <sect1>
    <title>Using The Framework</title>
    <para>To support connector monitoring, your Connector implementation must extend the
      MonitoredConnector interface and implement the single getStatus() method to return a
      ConnectionStatus.
       </para>
    <para>A monitored connector will be polled for status in the Teiid Enterprise Server
      (connector monitoring is not supported on Teiid Query or Dimension products).  The poll
      rate is the value of the metamatrix.server.serviceMonitorInterval system property, which can
      be set in the Teiid Console.  This property defaults to 60 seconds.  If the
      ConnectionStatus indicates an AliveStatus of DEAD, then the connector is marked in the service
      registry as “data source unavailable”.  If the ConnectionStatus indicates an AliveStatus of
      ALIVE, the connector is marked as “open”.  An AliveStatus of UNKNOWN does not change the state
      of the registry.</para>
    <para>In addition, the Admin API can be used in Teiid Query and Teiid Enterprise to
      obtain the status of connectors at runtime.  For more information, see the Admin API Javadoc.
    </para>
  </sect1>
</chapter>